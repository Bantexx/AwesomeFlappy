@inject NavigationManager Nav
@inject GameSettingsService SettingsService
@inject PersistenceService Persistence
@using AwesomeFlappyClient.Services

<div class="menu-centered">
    <div style="display:flex;flex-direction:column;align-items:center;gap:8px;">
        <div class="preview">
            <img src="@($"images/bird{SettingsService.SelectedCharacterIndex + 1}.svg")" alt="avatar" width="84" height="84" />
        </div>
        <div class="menu-title">Flappy Mini</div>
        <div class="center-note">One‑hand friendly — tap anywhere to flap</div>
    </div>

    <div class="btn-row" style="margin-top:12px;">
        <button class="primary-btn" @onclick="NavigationGame">Play</button>
    </div>

    <div class="btn-row" style="margin-top:10px;">
        <button class="secondary-btn" @onclick="NavigationLeaderboard">Leaderboard</button>
        <button class="secondary-btn" @onclick="NavigationSettings">Settings</button>
    </div>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        // ensure settings loaded from persistence if present
        var (selChar, diff) = await Persistence.LoadSettingsAsync();
        SettingsService.SelectedCharacterIndex = selChar;
        SettingsService.Difficulty = diff;
    }
    
    private void NavigationGame() => Nav.NavigateTo("game");
    
    private void NavigationLeaderboard() => Nav.NavigateTo("leaderboard");
    
    private void NavigationSettings() => Nav.NavigateTo("settings");
    
}